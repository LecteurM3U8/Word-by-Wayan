<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word by Wayan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .dropdown:hover .dropdown-menu {
            display: block;
        }
        .dropdown-menu {
            display: none;
        }
        .dropdown:hover .dropdown-menu,
        .dropdown-menu:hover {
            display: block;
        }
        .resize-handle {
            width: 10px;
            height: 10px;
            background: #4285f4;
            position: absolute;
            right: 0;
            bottom: 0;
            cursor: nwse-resize;
        }
        #editor {
            min-height: 500px;
            padding: 20px;
            outline: none;
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .tooltip {
            position: relative;
        }
        .tooltip-text {
            visibility: hidden;
            width: 120px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        #editor:empty:before {
            content: attr(data-placeholder);
            color: gray;
            pointer-events: none;
        }
        
        /* Thème sombre */
        .dark-theme {
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .dark-theme #editor {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        .dark-theme .bg-gray-100 {
            background-color: #2d3748;
        }
        .dark-theme .border-b, .dark-theme .border-t {
            border-color: #4a5568;
        }
        .dark-theme .dropdown-menu {
            background-color: #2d3748;
            border-color: #4a5568;
        }
        .dark-theme .dropdown-menu a:hover {
            background-color: #4a5568;
        }
        .dark-theme .bg-white {
            background-color: #2d3748;
        }
        .dark-theme .text-gray-700 {
            color: #e2e8f0;
        }
        .dark-theme .border {
            border-color: #4a5568;
        }
        .dark-theme input, .dark-theme select {
            background-color: #4a5568;
            color: #e2e8f0;
            border-color: #4a5568;
        }
        
        /* Thème personnalisé */
        .custom-theme {
            background-color: #f0f7ff;
            color: #1a365d;
        }
        .custom-theme #editor {
            background-color: #ffffff;
            color: #1a365d;
            border-left: 1px solid #bee3f8;
            border-right: 1px solid #bee3f8;
        }
        .custom-theme .bg-gray-100 {
            background-color: #ebf8ff;
        }
        .custom-theme .border-b, .custom-theme .border-t {
            border-color: #bee3f8;
        }
        .custom-theme .dropdown-menu {
            background-color: #ebf8ff;
            border-color: #bee3f8;
        }
        .custom-theme .dropdown-menu a:hover {
            background-color: #bee3f8;
        }
        .custom-theme .bg-white {
            background-color: #ffffff;
        }
        .custom-theme input, .custom-theme select {
            background-color: #ffffff;
            color: #1a365d;
            border-color: #bee3f8;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 modal hidden">
        <div class="bg-white rounded-lg p-6 w-96">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Connexion</h2>
                <button onclick="closeModal('loginModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="email">Email</label>
                    <input type="email" id="email" class="w-full px-3 py-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="password">Mot de passe</label>
                    <input type="password" id="password" class="w-full px-3 py-2 border rounded" required>
                </div>
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center">
                        <input type="checkbox" id="remember" class="mr-2">
                        <label for="remember">Se souvenir de moi</label>
                    </div>
                    <a href="#" class="text-blue-500 hover:underline">Mot de passe oublié?</a>
                </div>
                <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">Se connecter</button>
            </form>
            <div class="mt-4 text-center">
                <p>Pas de compte? <a href="#" onclick="showRegister()" class="text-blue-500 hover:underline">S'inscrire</a></p>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 modal hidden">
        <div class="bg-white rounded-lg p-6 w-96">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Inscription</h2>
                <button onclick="closeModal('registerModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="registerForm">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regName">Nom complet</label>
                    <input type="text" id="regName" class="w-full px-3 py-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regEmail">Email</label>
                    <input type="email" id="regEmail" class="w-full px-3 py-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regPassword">Mot de passe</label>
                    <input type="password" id="regPassword" class="w-full px-3 py-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regConfirm">Confirmer le mot de passe</label>
                    <input type="password" id="regConfirm" class="w-full px-3 py-2 border rounded" required>
                </div>
                <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">S'inscrire</button>
            </form>
            <div class="mt-4 text-center">
                <p>Déjà un compte? <a href="#" onclick="showLogin()" class="text-blue-500 hover:underline">Se connecter</a></p>
            </div>
        </div>
    </div>

    <!-- Save Modal -->
    <div id="saveModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 modal hidden">
        <div class="bg-white rounded-lg p-6 w-1/2">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Enregistrer le document</h2>
                <button onclick="closeModal('saveModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2" for="fileName">Nom du fichier</label>
                <input type="text" id="fileName" class="w-full px-3 py-2 border rounded" value="Document sans titre">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Format de fichier</label>
                <div class="grid grid-cols-3 gap-4">
                    <div class="border rounded p-3 hover:bg-gray-100 cursor-pointer" onclick="selectFormat('docx')">
                        <i class="far fa-file-word text-blue-500 text-2xl mb-2"></i>
                        <p>Document Word (.docx)</p>
                    </div>
                    <div class="border rounded p-3 hover:bg-gray-100 cursor-pointer" onclick="selectFormat('pdf')">
                        <i class="far fa-file-pdf text-red-500 text-2xl mb-2"></i>
                        <p>PDF (.pdf)</p>
                    </div>
                    <div class="border rounded p-3 hover:bg-gray-100 cursor-pointer" onclick="selectFormat('txt')">
                        <i class="far fa-file-alt text-gray-500 text-2xl mb-2"></i>
                        <p>Texte brut (.txt)</p>
                    </div>
                    <div class="border rounded p-3 hover:bg-gray-100 cursor-pointer" onclick="selectFormat('html')">
                        <i class="far fa-file-code text-green-500 text-2xl mb-2"></i>
                        <p>HTML (.html)</p>
                    </div>
                    <div class="border rounded p-3 hover:bg-gray-100 cursor-pointer" onclick="selectFormat('odt')">
                        <i class="far fa-file-word text-purple-500 text-2xl mb-2"></i>
                        <p>OpenDocument (.odt)</p>
                    </div>
                    <div class="border rounded p-3 hover:bg-gray-100 cursor-pointer" onclick="selectFormat('rtf')">
                        <i class="far fa-file-word text-orange-500 text-2xl mb-2"></i>
                        <p>Rich Text Format (.rtf)</p>
                    </div>
                </div>
            </div>
            <div class="flex justify-end mt-4">
                <button onclick="closeModal('saveModal')" class="px-4 py-2 border rounded mr-2">Annuler</button>
                <button onclick="saveDocument()" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 modal hidden">
        <div class="bg-white rounded-lg p-6 w-1/2">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Importer un fichier</h2>
                <button onclick="closeModal('uploadModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                <p class="text-gray-500 mb-2">Glissez-déposez vos fichiers ici ou</p>
                <input type="file" id="fileInput" class="hidden">
                <button onclick="document.getElementById('fileInput').click()" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Parcourir</button>
            </div>
            <div class="flex justify-end mt-4">
                <button onclick="closeModal('uploadModal')" class="px-4 py-2 border rounded mr-2">Annuler</button>
                <button onclick="uploadFile()" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Importer</button>
            </div>
        </div>
    </div>

    <!-- Theme Customization Modal -->
    <div id="themeModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 modal hidden">
        <div class="bg-white rounded-lg p-6 w-96">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Personnaliser le thème</h2>
                <button onclick="closeModal('themeModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Couleur principale</label>
                <input type="color" id="primaryColor" value="#3182ce" class="w-full">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Couleur de fond</label>
                <input type="color" id="bgColor" value="#f0f7ff" class="w-full">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Couleur du texte</label>
                <input type="color" id="textColor" value="#1a365d" class="w-full">
            </div>
            <div class="flex justify-end mt-4">
                <button onclick="closeModal('themeModal')" class="px-4 py-2 border rounded mr-2">Annuler</button>
                <button onclick="applyCustomTheme()" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Appliquer</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="flex flex-col h-screen">
        <!-- Title Bar -->
        <div class="bg-gray-800 text-white p-2 flex justify-between items-center">
            <div class="flex items-center">
                <i class="fas fa-file-word text-blue-400 text-xl mr-2"></i>
                <span class="font-semibold">Word by Wayan</span>
                <span id="documentTitle" class="ml-2">- Document sans titre</span>
            </div>
            <div class="flex items-center">
                <button onclick="minimizeWindow()" class="p-1 hover:bg-gray-700 rounded">
                    <i class="fas fa-minus"></i>
                </button>
                <button onclick="maximizeWindow()" class="p-1 hover:bg-gray-700 rounded mx-1">
                    <i class="far fa-square"></i>
                </button>
                <button onclick="closeWindow()" class="p-1 hover:bg-red-500 rounded">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- Menu Bar -->
        <div class="bg-gray-100 border-b flex items-center px-4 py-1">
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded flex items-center">
                    <span>Fichier</span>
                </button>
                <div class="dropdown-menu absolute left-0 mt-1 w-48 bg-white shadow-lg rounded-md py-1 z-10">
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="newDocument()">Nouveau</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="document.execCommand('open', false, null)">Ouvrir</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="showSaveModal()">Enregistrer</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="showSaveModal()">Enregistrer sous</a>
                    <div class="border-t my-1"></div>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="showUploadModal()">Importer</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="window.print()">Imprimer</a>
                    <div class="border-t my-1"></div>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="showLogin()">Se connecter</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="closeWindow()">Quitter</a>
                </div>
            </div>
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded">Accueil</button>
                <div class="dropdown-menu absolute left-0 mt-1 w-64 bg-white shadow-lg rounded-md py-1 z-10">
                    <div class="grid grid-cols-3 gap-2 p-2">
                        <button class="p-2 hover:bg-gray-100 rounded tooltip" onclick="formatText('bold')">
                            <i class="fas fa-bold"></i>
                            <span class="tooltip-text">Gras (Ctrl+B)</span>
                        </button>
                        <button class="p-2 hover:bg-gray-100 rounded tooltip" onclick="formatText('italic')">
                            <i class="fas fa-italic"></i>
                            <span class="tooltip-text">Italique (Ctrl+I)</span>
                        </button>
                        <button class="p-2 hover:bg-gray-100 rounded tooltip" onclick="formatText('underline')">
                            <i class="fas fa-underline"></i>
                            <span class="tooltip-text">Souligné (Ctrl+U)</span>
                        </button>
                        <button class="p-2 hover:bg-gray-100 rounded tooltip" onclick="formatText('strikethrough')">
                            <i class="fas fa-strikethrough"></i>
                            <span class="tooltip-text">Barré</span>
                        </button>
                        <button class="p-2 hover:bg-gray-100 rounded tooltip" onclick="formatText('superscript')">
                            <i class="fas fa-superscript"></i>
                            <span class="tooltip-text">Exposant</span>
                        </button>
                        <button class="p-2 hover:bg-gray-100 rounded tooltip" onclick="formatText('subscript')">
                            <i class="fas fa-subscript"></i>
                            <span class="tooltip-text">Indice</span>
                        </button>
                    </div>
                    <div class="border-t my-1"></div>
                    <div class="p-2">
                        <label class="block mb-1">Police</label>
                        <select id="fontFamily" class="w-full p-1 border rounded" onchange="changeFontFamily()">
                            <option value="Arial">Arial</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Courier New">Courier New</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Verdana">Verdana</option>
                            <option value="Comic Sans MS">Comic Sans MS</option>
                        </select>
                    </div>
                    <div class="p-2">
                        <label class="block mb-1">Taille</label>
                        <select id="fontSize" class="w-full p-1 border rounded" onchange="changeFontSize()">
                            <option value="1">8</option>
                            <option value="2">10</option>
                            <option value="3">12</option>
                            <option value="4">14</option>
                            <option value="5">18</option>
                            <option value="6">24</option>
                            <option value="7">36</option>
                        </select>
                    </div>
                    <div class="p-2">
                        <label class="block mb-1">Couleur</label>
                        <input type="color" id="textColor" class="w-full" onchange="changeTextColor()">
                    </div>
                </div>
            </div>
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded">Insertion</button>
                <div class="dropdown-menu absolute left-0 mt-1 w-64 bg-white shadow-lg rounded-md py-1 z-10">
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="insertImage()">Image</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="insertTable()">Tableau</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="insertLink()">Lien</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="insertComment()">Commentaire</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="insertEquation()">Équation</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="insertSymbol()">Symbole</a>
                </div>
            </div>
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded">Mise en page</button>
                <div class="dropdown-menu absolute left-0 mt-1 w-64 bg-white shadow-lg rounded-md py-1 z-10">
                    <div class="p-2">
                        <label class="block mb-1">Orientation</label>
                        <div class="flex">
                            <button class="flex-1 p-2 border hover:bg-gray-100" onclick="setOrientation('portrait')">
                                <i class="fas fa-file-alt"></i> Portrait
                            </button>
                            <button class="flex-1 p-2 border hover:bg-gray-100" onclick="setOrientation('landscape')">
                                <i class="fas fa-file-alt"></i> Paysage
                            </button>
                        </div>
                    </div>
                    <div class="p-2">
                        <label class="block mb-1">Marges</label>
                        <select class="w-full p-1 border rounded">
                            <option>Normales</option>
                            <option>Étroites</option>
                            <option>Modérées</option>
                            <option>Larges</option>
                        </select>
                    </div>
                    <div class="p-2">
                        <label class="block mb-1">Alignement</label>
                        <div class="grid grid-cols-3 gap-1">
                            <button class="p-2 border hover:bg-gray-100" onclick="setAlignment('left')">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button class="p-2 border hover:bg-gray-100" onclick="setAlignment('center')">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button class="p-2 border hover:bg-gray-100" onclick="setAlignment('right')">
                                <i class="fas fa-align-right"></i>
                            </button>
                            <button class="p-2 border hover:bg-gray-100" onclick="setAlignment('justify')">
                                <i class="fas fa-align-justify"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded">Références</button>
                <div class="dropdown-menu absolute left-0 mt-1 w-64 bg-white shadow-lg rounded-md py-1 z-10">
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Table des matières</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Note de bas de page</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Citation</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Bibliographie</a>
                </div>
            </div>
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded">Révision</button>
                <div class="dropdown-menu absolute left-0 mt-1 w-64 bg-white shadow-lg rounded-md py-1 z-10">
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="spellCheck()">Vérification orthographique</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Traduction</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Commentaires</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100">Suivi des modifications</a>
                </div>
            </div>
            <div class="dropdown relative">
                <button class="px-3 py-1 hover:bg-gray-200 rounded">Affichage</button>
                <div class="dropdown-menu absolute left-0 mt-1 w-64 bg-white shadow-lg rounded-md py-1 z-10">
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="setView('print')">Mise en page</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="setView('web')">Web</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="zoomIn()">
                        <i class="fas fa-search-plus"></i> Zoom avant
                    </a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="zoomOut()">
                        <i class="fas fa-search-minus"></i> Zoom arrière
                    </a>
                    <div class="border-t my-1"></div>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="setTheme('light')">
                        <i class="fas fa-sun"></i> Thème clair
                    </a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="setTheme('dark')">
                        <i class="fas fa-moon"></i> Thème sombre
                    </a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-100" onclick="showThemeModal()">
                        <i class="fas fa-palette"></i> Personnaliser
                    </a>
                </div>
            </div>
            <div class="ml-auto">
                <button onclick="showLogin()" class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600">
                    <i class="fas fa-user mr-1"></i> Se connecter
                </button>
            </div>
        </div>

        <!-- Toolbar -->
        <div class="bg-gray-100 border-b p-2 flex flex-wrap items-center">
            <!-- File Operations -->
            <div class="flex items-center mr-4">
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="newDocument()">
                    <i class="far fa-file text-blue-500"></i>
                    <span class="tooltip-text">Nouveau (Ctrl+N)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="document.execCommand('open', false, null)">
                    <i class="far fa-folder-open text-blue-500"></i>
                    <span class="tooltip-text">Ouvrir (Ctrl+O)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="showSaveModal()">
                    <i class="far fa-save text-blue-500"></i>
                    <span class="tooltip-text">Enregistrer (Ctrl+S)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="window.print()">
                    <i class="fas fa-print text-blue-500"></i>
                    <span class="tooltip-text">Imprimer (Ctrl+P)</span>
                </button>
            </div>

            <!-- Clipboard -->
            <div class="flex items-center mr-4">
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="document.execCommand('cut', false, null)">
                    <i class="far fa-cut text-blue-500"></i>
                    <span class="tooltip-text">Couper (Ctrl+X)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="document.execCommand('copy', false, null)">
                    <i class="far fa-copy text-blue-500"></i>
                    <span class="tooltip-text">Copier (Ctrl+C)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="document.execCommand('paste', false, null)">
                    <i class="far fa-paste text-blue-500"></i>
                    <span class="tooltip-text">Coller (Ctrl+V)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="document.execCommand('undo', false, null)">
                    <i class="fas fa-undo text-blue-500"></i>
                    <span class="tooltip-text">Annuler (Ctrl+Z)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="document.execCommand('redo', false, null)">
                    <i class="fas fa-redo text-blue-500"></i>
                    <span class="tooltip-text">Rétablir (Ctrl+Y)</span>
                </button>
            </div>

            <!-- Font Formatting -->
            <div class="flex items-center mr-4">
                <select id="fontFamilyToolbar" class="p-1 border rounded mr-2" onchange="changeFontFamily()">
                    <option value="Arial">Arial</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Verdana">Verdana</option>
                </select>
                <select id="fontSizeToolbar" class="p-1 border rounded mr-2" onchange="changeFontSize()">
                    <option value="3">12</option>
                    <option value="4">14</option>
                    <option value="5">18</option>
                    <option value="6">24</option>
                    <option value="7">36</option>
                </select>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="formatText('bold')">
                    <i class="fas fa-bold"></i>
                    <span class="tooltip-text">Gras (Ctrl+B)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="formatText('italic')">
                    <i class="fas fa-italic"></i>
                    <span class="tooltip-text">Italique (Ctrl+I)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="formatText('underline')">
                    <i class="fas fa-underline"></i>
                    <span class="tooltip-text">Souligné (Ctrl+U)</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="formatText('strikethrough')">
                    <i class="fas fa-strikethrough"></i>
                    <span class="tooltip-text">Barré</span>
                </button>
                <input type="color" id="textColorToolbar" class="w-6 h-6" onchange="changeTextColor()">
            </div>

            <!-- Paragraph Formatting -->
            <div class="flex items-center mr-4">
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="setAlignment('left')">
                    <i class="fas fa-align-left"></i>
                    <span class="tooltip-text">Aligner à gauche</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="setAlignment('center')">
                    <i class="fas fa-align-center"></i>
                    <span class="tooltip-text">Centrer</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="setAlignment('right')">
                    <i class="fas fa-align-right"></i>
                    <span class="tooltip-text">Aligner à droite</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="setAlignment('justify')">
                    <i class="fas fa-align-justify"></i>
                    <span class="tooltip-text">Justifier</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="changeLineHeight()">
                    <i class="fas fa-text-height"></i>
                    <span class="tooltip-text">Interligne</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="changeParagraphSpacing()">
                    <i class="fas fa-paragraph"></i>
                    <span class="tooltip-text">Espacement des paragraphes</span>
                </button>
            </div>

            <!-- Insert -->
            <div class="flex items-center">
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="insertImage()">
                    <i class="far fa-image text-blue-500"></i>
                    <span class="tooltip-text">Insérer une image</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="insertTable()">
                    <i class="fas fa-table text-blue-500"></i>
                    <span class="tooltip-text">Insérer un tableau</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="insertLink()">
                    <i class="fas fa-link text-blue-500"></i>
                    <span class="tooltip-text">Insérer un lien</span>
                </button>
                <button class="p-2 hover:bg-gray-200 rounded tooltip" onclick="insertComment()">
                    <i class="far fa-comment text-blue-500"></i>
                    <span class="tooltip-text">Insérer un commentaire</span>
                </button>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="bg-gray-100 border-t p-1 flex justify-between items-center text-sm">
            <div class="flex items-center">
                <span id="pageCount" class="mr-4">Page 1 sur 1</span>
                <span id="wordCount">0 mots</span>
            </div>
            <div class="flex items-center">
                <span id="language" class="mr-4">Français</span>
                <span id="zoomLevel" class="mr-2">100%</span>
                <button class="p-1 hover:bg-gray-200 rounded" onclick="zoomOut()">
                    <i class="fas fa-search-minus"></i>
                </button>
                <div class="w-24 mx-1">
                    <input type="range" min="50" max="200" value="100" class="w-full" oninput="changeZoom(this.value)">
                </div>
                <button class="p-1 hover:bg-gray-200 rounded" onclick="zoomIn()">
                    <i class="fas fa-search-plus"></i>
                </button>
            </div>
        </div>

        <!-- Document Area -->
        <div class="flex-1 overflow-auto bg-white">
            <div id="editor" contenteditable="true" class="mx-auto" style="width: 8.5in;" data-placeholder="Commencez à taper ici..."></div>
        </div>
    </div>

    <script>
        // Document state
        let currentDocument = {
            name: "Document sans titre",
            content: "",
            format: "docx",
            saved: false
        };

        // User state
        let user = null;

        // Initialize the editor
        document.addEventListener('DOMContentLoaded', function() {
            updateWordCount();
            
            // Add event listeners for keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Ctrl+S - Save
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    showSaveModal();
                }
                // Ctrl+N - New
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    newDocument();
                }
                // Ctrl+O - Open
                if (e.ctrlKey && e.key === 'o') {
                    e.preventDefault();
                    document.execCommand('open', false, null);
                }
                // Ctrl+P - Print
                if (e.ctrlKey && e.key === 'p') {
                    e.preventDefault();
                    window.print();
                }
            });

            // Update word count when typing
            document.getElementById('editor').addEventListener('input', updateWordCount);
            
            // Remove placeholder on first click
            const editor = document.getElementById('editor');
            editor.addEventListener('click', function() {
                if (editor.innerHTML === '') {
                    editor.innerHTML = '<p><br></p>';
                }
            }, { once: true });
            
            // Handle paste to clean up formatting
            editor.addEventListener('paste', function(e) {
                e.preventDefault();
                const text = (e.clipboardData || window.clipboardData).getData('text/plain');
                document.execCommand('insertText', false, text);
            });
        });

        // Modal functions
        function showModal(id) {
            document.getElementById(id).classList.remove('hidden');
        }

        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }

        function showLogin() {
            closeModal('registerModal');
            showModal('loginModal');
        }

        function showRegister() {
            closeModal('loginModal');
            showModal('registerModal');
        }

        function showSaveModal() {
            showModal('saveModal');
        }

        function showUploadModal() {
            showModal('uploadModal');
        }

        function showThemeModal() {
            showModal('themeModal');
        }

        // Theme functions
        function setTheme(theme) {
            document.body.classList.remove('dark-theme', 'custom-theme');
            
            if (theme === 'dark') {
                document.body.classList.add('dark-theme');
            } else if (theme === 'custom') {
                document.body.classList.add('custom-theme');
            }
            
            // Light theme is default, no class needed
        }

        function applyCustomTheme() {
            const primaryColor = document.getElementById('primaryColor').value;
            const bgColor = document.getElementById('bgColor').value;
            const textColor = document.getElementById('textColor').value;
            
            // Create a style element for the custom theme
            let style = document.getElementById('custom-theme-style');
            if (!style) {
                style = document.createElement('style');
                style.id = 'custom-theme-style';
                document.head.appendChild(style);
            }
            
            // Apply the custom colors
            style.textContent = `
                .custom-theme {
                    background-color: ${bgColor};
                    color: ${textColor};
                }
                .custom-theme #editor {
                    background-color: ${lightenColor(bgColor, 10)};
                    color: ${textColor};
                    border-left: 1px solid ${primaryColor};
                    border-right: 1px solid ${primaryColor};
                }
                .custom-theme .bg-gray-100 {
                    background-color: ${lightenColor(bgColor, 5)};
                }
                .custom-theme .border-b, .custom-theme .border-t {
                    border-color: ${primaryColor};
                }
                .custom-theme .dropdown-menu {
                    background-color: ${lightenColor(bgColor, 5)};
                    border-color: ${primaryColor};
                }
                .custom-theme .dropdown-menu a:hover {
                    background-color: ${primaryColor};
                    color: white;
                }
                .custom-theme .bg-white {
                    background-color: ${lightenColor(bgColor, 10)};
                }
                .custom-theme input, .custom-theme select {
                    background-color: ${lightenColor(bgColor, 10)};
                    color: ${textColor};
                    border-color: ${primaryColor};
                }
                .custom-theme .tooltip-text {
                    background-color: ${primaryColor};
                    color: white;
                }
            `;
            
            setTheme('custom');
            closeModal('themeModal');
        }

        function lightenColor(color, percent) {
            // Simple function to lighten a color
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = Math.min(255, (num >> 16) + amt);
            const G = Math.min(255, ((num >> 8) & 0x00FF) + amt);
            const B = Math.min(255, (num & 0x0000FF) + amt);
            return `#${(1 << 24 | R << 16 | G << 8 | B).toString(16).slice(1)}`;
        }

        // User authentication
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Simple validation
            if (email && password) {
                user = {
                    email: email,
                    name: "Utilisateur"
                };
                closeModal('loginModal');
                alert(`Bienvenue ${user.name}!`);
            } else {
                alert('Veuillez remplir tous les champs');
            }
        });

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const confirm = document.getElementById('regConfirm').value;
            
            // Simple validation
            if (name && email && password && confirm) {
                if (password === confirm) {
                    user = {
                        email: email,
                        name: name
                    };
                    closeModal('registerModal');
                    alert(`Bienvenue ${user.name}! Votre compte a été créé.`);
                } else {
                    alert('Les mots de passe ne correspondent pas');
                }
            } else {
                alert('Veuillez remplir tous les champs');
            }
        });

        // Document operations
        function newDocument() {
            if (!currentDocument.saved && confirm('Voulez-vous enregistrer les modifications avant de créer un nouveau document?')) {
                showSaveModal();
                return;
            }
            document.getElementById('editor').innerHTML = '<p><br></p>';
            currentDocument.name = "Document sans titre";
            currentDocument.saved = false;
            updateDocumentTitle();
            updateWordCount();
        }

        function saveDocument() {
            const fileName = document.getElementById('fileName').value || "Document sans titre";
            const format = currentDocument.format;
            
            currentDocument.name = fileName;
            currentDocument.content = document.getElementById('editor').innerHTML;
            currentDocument.saved = true;
            
            updateDocumentTitle();
            closeModal('saveModal');
            
            // Create a download link with appropriate content type
            let blob, type;
            switch(format) {
                case 'docx':
                    // For DOCX we would need a library, here we'll use HTML as fallback
                    type = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
                    blob = new Blob([currentDocument.content], { type: 'text/html' });
                    break;
                case 'pdf':
                    // PDF would need a library like jsPDF
                    type = 'application/pdf';
                    blob = new Blob([currentDocument.content], { type: 'text/html' });
                    break;
                case 'txt':
                    type = 'text/plain';
                    blob = new Blob([document.getElementById('editor').innerText], { type });
                    break;
                case 'html':
                    type = 'text/html';
                    blob = new Blob([currentDocument.content], { type });
                    break;
                case 'odt':
                    type = 'application/vnd.oasis.opendocument.text';
                    blob = new Blob([currentDocument.content], { type: 'text/html' });
                    break;
                case 'rtf':
                    type = 'application/rtf';
                    // RTF is complex, this is a simplified version
                    const rtfContent = `{\\rtf1\\ansi\\ansicpg1252\\deff0\\nouicompat\\deflang1036
{\\fonttbl{\\f0\\fnil\\fcharset0 Calibri;}}
{\\*\\generator Riched20 10.0.19041}\\viewkind4\\uc1 
\\pard\\sa200\\sl276\\slmult1\\f0\\fs22\\lang12\\par
${document.getElementById('editor').innerText.replace(/\n/g, '\\par ')}
}`;
                    blob = new Blob([rtfContent], { type });
                    break;
                default:
                    type = 'text/html';
                    blob = new Blob([currentDocument.content], { type });
            }
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${fileName}.${format}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`Document "${fileName}" enregistré au format ${format.toUpperCase()}`);
        }

        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    document.getElementById('editor').innerHTML = e.target.result;
                    currentDocument.name = file.name.split('.')[0];
                    currentDocument.saved = false;
                    updateDocumentTitle();
                    updateWordCount();
                    closeModal('uploadModal');
                    alert(`Fichier "${file.name}" importé avec succès`);
                };
                
                if (file.name.endsWith('.txt')) {
                    reader.readAsText(file);
                } else {
                    reader.readAsDataURL(file);
                }
            } else {
                alert('Veuillez sélectionner un fichier');
            }
        }

        function selectFormat(format) {
            currentDocument.format = format;
            // Highlight selected format
            document.querySelectorAll('#saveModal .grid > div').forEach(div => {
                div.classList.remove('bg-blue-100', 'border-blue-300');
            });
            event.currentTarget.classList.add('bg-blue-100', 'border-blue-300');
        }

        // Formatting functions
        function formatText(command, value = null) {
            document.execCommand(command, false, value);
            document.getElementById('editor').focus();
        }

        function changeFontFamily() {
            const font = document.getElementById('fontFamilyToolbar').value || 
                         document.getElementById('fontFamily').value;
            formatText('fontName', font);
        }

        function changeFontSize() {
            const size = document.getElementById('fontSizeToolbar').value || 
                         document.getElementById('fontSize').value;
            formatText('fontSize', size);
        }

        function changeTextColor() {
            const color = document.getElementById('textColorToolbar').value || 
                          document.getElementById('textColor').value;
            formatText('foreColor', color);
        }

        function setAlignment(align) {
            formatText('justify' + align.charAt(0).toUpperCase() + align.slice(1));
        }

        function setOrientation(orientation) {
            const editor = document.getElementById('editor');
            if (orientation === 'landscape') {
                editor.style.width = '11in';
                editor.style.height = '8.5in';
            } else {
                editor.style.width = '8.5in';
                editor.style.height = 'auto';
            }
        }

        function changeLineHeight() {
            // This would need more complex implementation
            alert('Fonctionnalité d\'interligne à implémenter');
        }

        function changeParagraphSpacing() {
            // This would need more complex implementation
            alert('Fonctionnalité d\'espacement des paragraphes à implémenter');
        }

        // Insert functions
        function insertImage() {
            const url = prompt('Entrez l\'URL de l\'image:');
            if (url) {
                document.execCommand('insertHTML', false, `<img src="${url}" style="max-width: 100%;">`);
            }
        }

        function insertTable() {
            const rows = prompt('Nombre de lignes:', '3');
            const cols = prompt('Nombre de colonnes:', '3');
            
            if (rows && cols) {
                let table = '<table border="1" style="width: 100%; border-collapse: collapse;">';
                for (let i = 0; i < parseInt(rows); i++) {
                    table += '<tr>';
                    for (let j = 0; j < parseInt(cols); j++) {
                        table += `<td style="padding: 5px;">Cellule ${i+1},${j+1}</td>`;
                    }
                    table += '</tr>';
                }
                table += '</table>';
                document.execCommand('insertHTML', false, table);
            }
        }

        function insertLink() {
            const url = prompt('Entrez l\'URL du lien:', 'https://');
            if (url) {
                const text = prompt('Texte à afficher:', url);
                document.execCommand('createLink', false, url);
                // For custom text, we need to insert HTML
                if (text && text !== url) {
                    const selection = window.getSelection();
                    if (selection.rangeCount) {
                        const range = selection.getRangeAt(0);
                        range.deleteContents();
                        const a = document.createElement('a');
                        a.href = url;
                        a.textContent = text;
                        range.insertNode(a);
                    }
                }
            }
        }

        function insertComment() {
            const comment = prompt('Entrez votre commentaire:');
            if (comment) {
                document.execCommand('insertHTML', false, `<span style="background-color: yellow; color: black;">[Commentaire: ${comment}]</span>`);
            }
        }

        function insertEquation() {
            alert('Fonctionnalité d\'équation à implémenter');
        }

        function insertSymbol() {
            alert('Fonctionnalité de symbole à implémenter');
        }

        // View functions
        function setView(view) {
            const editor = document.getElementById('editor');
            if (view === 'print') {
                editor.style.backgroundColor = 'white';
                editor.style.boxShadow = '0 0 5px rgba(0,0,0,0.2)';
            } else {
                editor.style.backgroundColor = '';
                editor.style.boxShadow = '';
            }
        }

        function zoomIn() {
            const editor = document.getElementById('editor');
            const currentZoom = parseInt(editor.style.zoom || '100');
            const newZoom = Math.min(currentZoom + 10, 200);
            editor.style.zoom = newZoom + '%';
            document.getElementById('zoomLevel').textContent = newZoom + '%';
        }

        function zoomOut() {
            const editor = document.getElementById('editor');
            const currentZoom = parseInt(editor.style.zoom || '100');
            const newZoom = Math.max(currentZoom - 10, 50);
            editor.style.zoom = newZoom + '%';
            document.getElementById('zoomLevel').textContent = newZoom + '%';
        }

        function changeZoom(value) {
            const editor = document.getElementById('editor');
            editor.style.zoom = value + '%';
            document.getElementById('zoomLevel').textContent = value + '%';
        }

        // Window control functions
        function minimizeWindow() {
            alert('Fonctionnalité de minimisation à implémenter');
        }

        function maximizeWindow() {
            alert('Fonctionnalité de maximisation à implémenter');
        }

        function closeWindow() {
            if (!currentDocument.saved && confirm('Voulez-vous enregistrer les modifications avant de quitter?')) {
                showSaveModal();
                return;
            }
            alert('Fermeture de l\'application (dans une vraie app, cela fermerait la fenêtre)');
        }

        // Helper functions
        function updateDocumentTitle() {
            document.getElementById('documentTitle').textContent = currentDocument.saved ? 
                `- ${currentDocument.name}` : `- ${currentDocument.name} *`;
        }

        function updateWordCount() {
            const text = document.getElementById('editor').innerText;
            const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            document.getElementById('wordCount').textContent = `${wordCount} mots`;
        }

        function spellCheck() {
            alert('Fonctionnalité de vérification orthographique à implémenter');
        }
    </script>
</body>
</html>
